<!DOCTYPE html>
<html lang="{{ current_lang }}">
<head>
  <meta charset="UTF-8">
  <title>Reset Password</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style> body{background:#f8fafc} .center{max-width:560px;margin:40px auto}</style>
  </head>
<body>
  <section class="section">
    <div class="container center">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      <div class="notification is-light">
        {% for category, message in messages %}
          <div class="has-text-{{ 'danger' if category=='danger' else 'success' }}">{{ message }}</div>
        {% endfor %}
      </div>
      {% endif %}
      {% endwith %}
      <h1 class="title is-3">{{ 'ยืนยันรหัส OTP และตั้งรหัสผ่านใหม่' if current_lang=='th' else 'Enter OTP and Set New Password' }}</h1>
      <form method="post" class="box">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
        <div class="field">
          <label class="label">{{ 'ชื่อผู้ใช้' if current_lang=='th' else 'Username' }}</label>
          <div class="control">
            <input class="input" type="text" name="username" value="{{ username or '' }}" placeholder="Username" required>
          </div>
        </div>
        <div class="field">
          <label class="label">OTP</label>
          <div class="control">
            <input class="input" type="text" name="otp_code" maxlength="6" placeholder="6-digit code" required>
          </div>
        </div>
        <div class="field">
          <label class="label">{{ 'รหัสผ่านใหม่' if current_lang=='th' else 'New Password' }}</label>
          <div class="control">
            <input class="input" type="password" name="new_password" required>
          </div>
        </div>
        <div class="field">
          <label class="label">{{ 'ยืนยันรหัสผ่านใหม่' if current_lang=='th' else 'Confirm New Password' }}</label>
          <div class="control">
            <input class="input" type="password" name="confirm_password" required>
          </div>
        </div>
        <div class="buttons">
          <button class="button is-link" type="submit">{{ 'เปลี่ยนรหัสผ่าน' if current_lang=='th' else 'Change Password' }}</button>
          <a class="button" href="{{ url_for('continuing_edu.login', lang=current_lang) }}">{{ 'เข้าสู่ระบบ' if current_lang=='th' else 'Back to Login' }}</a>
        </div>
      </form>
    </div>
  </section>
</body>
</html>

