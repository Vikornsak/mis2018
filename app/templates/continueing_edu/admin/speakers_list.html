{% extends 'continueing_edu/admin/base.html' %}
{% block content %}
<div class="container">
  <h1 class="title is-3">Speaker Profiles</h1>
  <form method="get" class="field has-addons mb-4">
    <div class="control is-expanded">
      <input class="input" type="text" name="q" placeholder="Search by name, email, institution" value="{{ q or '' }}">
    </div>
    <div class="control">
      <button class="button is-link" type="submit">Search</button>
    </div>
    <div class="control">
      <a class="button" href="{{ url_for('continuing_edu_admin.speakers_index') }}">Reset</a>
    </div>
  </form>
  <a class="button is-primary mb-4" href="{{ url_for('continuing_edu_admin.speakers_new') }}">New Speaker</a>

  {% if profiles %}
  <table class="table is-fullwidth is-striped is-hoverable">
    <thead>
      <tr>
        <th class="is-narrow">Photo</th>
        <th>Name</th>
        <th>Email</th>
        <th>Institution</th>
        <th>Status</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for s in profiles %}
      <tr>
        <td class="is-vcentered">
          {% set avatar = s.image_url or 'https://via.placeholder.com/64x64?text=SP' %}
          <figure class="image is-64x64" style="object-fit:cover;">
            <img src="{{ avatar }}" alt="{{ s.name_en }}">
          </figure>

        </td>
        <td>
          <a href="{{ url_for('continuing_edu_admin.speakers_view', profile_id=s.id) }}"
            class="has-text-weight-semibold">{{ s.name_en }}</a>
          <br>
          <span class="is-size-7 has-text-grey">{{ s.name_th }}</span>
          {% if s.position_en or s.position_th %}
          <div class="is-size-7 has-text-grey">{{ s.position_en or s.position_th }}</div>
          {% endif %}
        </td>
        <td>{{ s.email }}</td>
        <td>{{ s.institution_en }}<br><span class="is-size-7 has-text-grey">{{ s.institution_th }}</span></td>
        <td>
          {% if s.is_active %}
          <span class="tag is-success is-light">Active</span>
          {% else %}
          <span class="tag is-light">Inactive</span>
          {% endif %}
        </td>
        <td class="has-text-right">
          <a class="button is-small"
            href="{{ url_for('continuing_edu_admin.speakers_view', profile_id=s.id) }}">View</a>
          <a class="button is-small is-link"
            href="{{ url_for('continuing_edu_admin.speakers_edit', profile_id=s.id) }}">Edit</a>
          <form method="post" action="{{ url_for('continuing_edu_admin.speakers_delete', profile_id=s.id) }}"
            style="display:inline" onsubmit="return confirm('Delete this speaker profile?');">
            <button class="button is-small is-danger" type="submit">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>No speaker profiles yet.</p>
  {% endif %}
</div>
{% endblock %}